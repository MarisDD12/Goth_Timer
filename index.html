<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pomodoro Timer - Display Only</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600&family=Cinzel:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Crimson Text', serif;
            background: transparent;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        /* Parchment texture overlay effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, transparent 20%, rgba(139, 121, 94, 0.02) 21%, rgba(139, 121, 94, 0.02) 34%, transparent 35%),
                linear-gradient(0deg, transparent 24%, rgba(165, 138, 104, 0.03) 25%, rgba(165, 138, 104, 0.03) 26%, transparent 27%, transparent 74%, rgba(165, 138, 104, 0.03) 75%, rgba(165, 138, 104, 0.03) 76%, transparent 77%);
            background-size: 30px 30px;
            pointer-events: none;
            opacity: 0.5;
        }

        /* Main timer container with ornate border */
        .timer-container {
            text-align: center;
            padding: 40px;
            --bg-opacity: 0.75;
            background: 
                linear-gradient(135deg, 
                    rgba(25, 38, 31, var(--bg-opacity)) 0%, 
                    rgba(42, 50, 45, calc(var(--bg-opacity) * 0.95)) 50%, 
                    rgba(25, 38, 31, var(--bg-opacity)) 100%);
            border-radius: 10px;
            box-shadow: 
                inset 0 0 30px rgba(212, 175, 100, 0.1),
                0 10px 40px rgba(0, 0, 0, 0.8),
                0 2px 4px rgba(0, 0, 0, 0.5),
                0 0 20px rgba(212, 175, 100, 0.4),
                inset 0 0 40px rgba(212, 175, 100, 0.15);
            min-width: 400px;
            position: relative;
            border: 3px solid rgba(212, 175, 100, 0.95);
            border-image: linear-gradient(
                135deg,
                rgba(212, 175, 100, 1),
                rgba(255, 215, 130, 0.9),
                rgba(212, 175, 100, 1)
            ) 1;
        }

        /* Decorative corners */
        .timer-container::before,
        .timer-container::after {
            content: '❦';
            position: absolute;
            font-size: 32px;
            color: rgba(212, 175, 100, 1);
            font-family: 'Cinzel', serif;
            text-shadow: 
                0 0 15px rgba(212, 175, 100, 0.9),
                0 0 25px rgba(212, 175, 100, 0.6),
                0 2px 4px rgba(0, 0, 0, 0.8),
                0 4px 8px rgba(0, 0, 0, 0.6);
            filter: drop-shadow(0 0 8px rgba(212, 175, 100, 0.8));
        }

        .timer-container::before {
            top: 15px;
            left: 20px;
        }

        .timer-container::after {
            bottom: 15px;
            right: 20px;
            transform: rotate(180deg);
        }

        /* Session label */
        .session-label {
            font-family: 'Cinzel', serif;
            font-size: 16px;
            font-weight: 600;
            color: #f4e8d0;
            text-transform: uppercase;
            letter-spacing: 4px;
            margin-bottom: 20px;
            position: relative;
            transition: all 0.5s ease;
            text-shadow: 
                0 0 10px rgba(212, 175, 100, 0.8),
                0 0 20px rgba(212, 175, 100, 0.5),
                2px 2px 4px rgba(0, 0, 0, 0.9),
                0 2px 8px rgba(0, 0, 0, 0.7);
            filter: drop-shadow(0 0 6px rgba(212, 175, 100, 0.6));
        }

        .session-label::before,
        .session-label::after {
            content: '—';
            margin: 0 10px;
            opacity: 1;
            color: rgba(212, 175, 100, 1);
        }

        .session-label.work {
            color: #f4e8d0;
        }

        .session-label.break {
            color: #ffd478;
        }

        .session-label.long-break {
            color: #ffb8b8;
        }

        /* Time display */
        .time-display {
            font-family: 'Crimson Text', serif;
            font-size: 86px;
            font-weight: 400;
            color: #f4e8d0;
            margin: 20px 0;
            letter-spacing: 6px;
            text-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.5),
                0 0 20px rgba(212, 175, 100, 0.1);
            transition: all 0.3s ease;
        }

        /* Progress ring container */
        .progress-ring {
            position: relative;
            width: 320px;
            height: 320px;
            margin: 0 auto;
        }

        .progress-ring svg {
            transform: rotate(-90deg);
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 0 8px rgba(212, 175, 100, 0.6)) drop-shadow(0 2px 5px rgba(0, 0, 0, 0.5));
        }

        .progress-ring-circle {
            fill: transparent;
            stroke-width: 5;
            transition: stroke-dashoffset 1s linear;
        }

        .progress-ring-bg {
            stroke: rgba(212, 175, 100, 0.3);
            stroke-width: 4;
        }

        .progress-ring-fill {
            stroke-linecap: round;
            filter: 
                drop-shadow(0 0 10px currentColor) 
                drop-shadow(0 0 20px currentColor);
        }

        .progress-ring-fill.work {
            stroke: #4a9d6a;
        }

        .progress-ring-fill.break {
            stroke: #f4d764;
        }

        .progress-ring-fill.long-break {
            stroke: #d46a6a;
        }

        /* Ornamental details */
        .ornament {
            position: absolute;
            font-family: 'Cinzel', serif;
            color: rgba(212, 175, 100, 1);
            font-size: 28px;
            text-shadow: 
                0 0 15px rgba(212, 175, 100, 0.9),
                0 0 25px rgba(212, 175, 100, 0.6),
                0 2px 4px rgba(0, 0, 0, 0.8),
                0 4px 8px rgba(0, 0, 0, 0.6);
            filter: drop-shadow(0 0 10px rgba(212, 175, 100, 0.8));
        }

        .ornament-top { top: -15px; left: 50%; transform: translateX(-50%); }
        .ornament-bottom { bottom: -15px; left: 50%; transform: translateX(-50%); }
        .ornament-left { left: -15px; top: 50%; transform: translateY(-50%) rotate(90deg); }
        .ornament-right { right: -15px; top: 50%; transform: translateY(-50%) rotate(-90deg); }

        /* Cycle counter */
        .cycle-counter {
            margin-top: 25px;
            font-size: 16px;
            color: #d4af64;
            letter-spacing: 2px;
            font-family: 'Crimson Text', serif;
            font-weight: 600;
            text-shadow: 
                0 0 8px rgba(212, 175, 100, 0.6),
                0 2px 4px rgba(0, 0, 0, 0.8);
        }

        .cycle-counter::before {
            content: '§ ';
            margin-right: 5px;
            color: rgba(212, 175, 100, 1);
        }

        .cycle-counter::after {
            content: ' §';
            margin-left: 5px;
            color: rgba(212, 175, 100, 1);
        }

        /* Latin phrase */
        .latin-phrase {
            margin-top: 15px;
            font-size: 14px;
            color: rgba(212, 175, 100, 0.85);
            font-style: italic;
            letter-spacing: 2px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        /* Lightning flash effect */
        @keyframes lightning {
            0%, 100% { opacity: 0; }
            10% { opacity: 0.3; }
            20% { opacity: 0; }
            30% { opacity: 0.5; }
            40%, 50% { opacity: 0; }
        }

        .lightning-flash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(212, 175, 100, 0.1);
            pointer-events: none;
            opacity: 0;
        }

        .lightning-flash.active {
            animation: lightning 1s ease-out;
        }

        /* Transition animation */
        @keyframes fadeTransition {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .timer-container.transitioning {
            animation: fadeTransition 2s ease-in-out;
        }
    </style>
</head>
<body>
    <!-- Lightning flash overlay -->
    <div class="lightning-flash" id="lightningFlash"></div>

    <!-- Main timer container -->
    <div class="timer-container" id="timerContainer">
        <!-- Session label -->
        <div class="session-label work" id="sessionLabel">— Focus Time —</div>
        
        <!-- Progress ring -->
        <div class="progress-ring">
            <svg>
                <circle class="progress-ring-circle progress-ring-bg" 
                        cx="160" cy="160" r="150"></circle>
                <circle class="progress-ring-circle progress-ring-fill work" 
                        cx="160" cy="160" r="150" 
                        id="progressRing"></circle>
            </svg>
            
            <!-- Ornamental symbols -->
            <div class="ornament ornament-top">✦</div>
            <div class="ornament ornament-bottom">✦</div>
            <div class="ornament ornament-left">✦</div>
            <div class="ornament ornament-right">✦</div>
            
            <!-- Time display -->
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                <div class="time-display" id="timeDisplay">25:00</div>
            </div>
        </div>
        
        <!-- Cycle counter -->
        <div class="cycle-counter" id="cycleCounter">Cycle I of IV</div>
        
        <!-- Latin phrase -->
        <div class="latin-phrase" id="latinPhrase">Tempus Fugit</div>
    </div>

    <script>
        // Latin phrases
        const latinPhrases = {
            work: ["Tempus Fugit", "Labor Omnia Vincit", "Scientia Potentia Est", "Per Aspera Ad Astra", "Ars Longa, Vita Brevis"],
            break: ["Otium Cum Dignitate", "In Quiete Vis", "Requiescat", "Momento Vivere"],
            longBreak: ["Mens Sana in Corpore Sano", "Carpe Diem", "Festina Lente"]
        };

        // Roman numerals
        const romanNumerals = ['I', 'II', 'III', 'IV', 'V', 'VI', 'VII', 'VIII', 'IX', 'X'];

        // Elements
        const timeDisplay = document.getElementById('timeDisplay');
        const sessionLabel = document.getElementById('sessionLabel');
        const cycleCounter = document.getElementById('cycleCounter');
        const progressRing = document.getElementById('progressRing');
        const timerContainer = document.getElementById('timerContainer');
        const latinPhrase = document.getElementById('latinPhrase');
        const lightningFlash = document.getElementById('lightningFlash');

        // Progress ring setup
        const radius = 150;
        const circumference = 2 * Math.PI * radius;
        progressRing.style.strokeDasharray = circumference;

        function getRandomPhrase(type) {
            const phrases = latinPhrases[type] || latinPhrases.work;
            return phrases[Math.floor(Math.random() * phrases.length)];
        }

        function updateDisplay(state) {
            // Update time
            const minutes = Math.floor(state.remainingSeconds / 60);
            const seconds = state.remainingSeconds % 60;
            timeDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Update progress ring
            const progress = (state.totalSeconds - state.remainingSeconds) / state.totalSeconds;
            const offset = circumference * (1 - progress);
            progressRing.style.strokeDashoffset = offset;
            
            // Update cycle counter
            const romanCycle = romanNumerals[state.currentCycle - 1] || state.currentCycle.toString();
            const romanTotal = romanNumerals[3] || '4'; // Default to 4 cycles
            cycleCounter.textContent = `Cycle ${romanCycle} of ${romanTotal}`;
            
            // Update session
            if (state.currentSession === 'work') {
                sessionLabel.textContent = '— Focus Time —';
                sessionLabel.className = 'session-label work';
                progressRing.className = 'progress-ring-circle progress-ring-fill work';
            } else if (state.currentSession === 'break') {
                sessionLabel.textContent = '— Short Break —';
                sessionLabel.className = 'session-label break';
                progressRing.className = 'progress-ring-circle progress-ring-fill break';
            } else if (state.currentSession === 'long-break') {
                sessionLabel.textContent = '— Long Break —';
                sessionLabel.className = 'session-label long-break';
                progressRing.className = 'progress-ring-circle progress-ring-fill long-break';
            }
        }

        function triggerTransition() {
            timerContainer.classList.add('transitioning');
            lightningFlash.classList.remove('active');
            void lightningFlash.offsetWidth;
            lightningFlash.classList.add('active');
            setTimeout(() => timerContainer.classList.remove('transitioning'), 2000);
        }

        // Listen for state changes from control panel
        let lastSession = 'work';
        
        window.addEventListener('storage', (e) => {
            if (e.key === 'pomodoroState') {
                const state = JSON.parse(e.newValue);
                updateDisplay(state);
                
                // Trigger transition effect when session changes
                if (state.currentSession !== lastSession) {
                    triggerTransition();
                    lastSession = state.currentSession;
                    
                    // Update Latin phrase
                    if (state.currentSession === 'work') {
                        latinPhrase.textContent = getRandomPhrase('work');
                    } else if (state.currentSession === 'break') {
                        latinPhrase.textContent = getRandomPhrase('break');
                    } else if (state.currentSession === 'long-break') {
                        latinPhrase.textContent = getRandomPhrase('longBreak');
                    }
                }
            }
        });

        // Initial load
        const savedState = localStorage.getItem('pomodoroState');
        if (savedState) {
            const state = JSON.parse(savedState);
            updateDisplay(state);
            lastSession = state.currentSession;
        }

        // Poll for updates (backup in case storage events don't fire)
        setInterval(() => {
            const state = localStorage.getItem('pomodoroState');
            if (state) {
                const parsedState = JSON.parse(state);
                updateDisplay(parsedState);
                
                if (parsedState.currentSession !== lastSession) {
                    triggerTransition();
                    lastSession = parsedState.currentSession;
                    
                    if (parsedState.currentSession === 'work') {
                        latinPhrase.textContent = getRandomPhrase('work');
                    } else if (parsedState.currentSession === 'break') {
                        latinPhrase.textContent = getRandomPhrase('break');
                    } else if (parsedState.currentSession === 'long-break') {
                        latinPhrase.textContent = getRandomPhrase('longBreak');
                    }
                }
            }
        }, 100);
    </script>
</body>
</html>
